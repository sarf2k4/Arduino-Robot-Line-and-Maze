#include <ArduinoRobot.h>
#include <Wire.h>
#include <SPI.h>

double THRESHOLD =500;
double MULTIPLIER =40; //values in %

double Speed = 255*(MULTIPLIER/100);
int State = 0;

int irs[5];

void setup()
{
  //Speed = 255*(MULTIPLIER/100);
  Serial.begin(9600);
  Robot.begin();
}

//void loop()
//{

  //dir();
//}

void loop()
{
  String stat = "";
  Robot.updateIR();
  for(int i=0; i<5; i++){
    irs[i]=Robot.IRarray[i];
  }

  // turn right
  turn_right(irs[0]);

  turn_right_less(irs[1], irs[2]);

  straight(irs[1],irs[2],irs[3]);
  
  turn_left_less(irs[2], irs[3]);
  
  turn_left(irs[4]);
  
  //motor_stop(irs[0],irs[1],irs[2],irs[3],irs[4]);
  delay(5);

}


void turn_right(int ir1)
{
  if (ir1 < THRESHOLD)
  {
    Robot.motorsWrite(Speed,-Speed);
  }
}

void turn_right_less(int ir1, int ir2) {
  if (ir1 < THRESHOLD || ((ir2 < THRESHOLD) && (ir1 < THRESHOLD)))
  {
    Robot.motorsWrite(Speed,-Speed);
  }
}

void turn_left_less (int ir2, int ir3){
  if (ir3 < THRESHOLD || ((ir2 < THRESHOLD) && (ir3 < THRESHOLD)))
  {
    Robot.motorsWrite(-Speed,Speed);
  }
}
  
void turn_left(int ir4){
  if (ir4 < THRESHOLD)
  {
    Robot.motorsWrite(-Speed,Speed);
  }
}

void straight(int ir1,int ir2, int ir3){
  if((ir2 < THRESHOLD))
    {
      Robot.motorsWrite(Speed,Speed);
    }
  if((ir1 < THRESHOLD) && (ir2 < THRESHOLD) && (ir3 < THRESHOLD))
  {
    Robot.motorsWrite(Speed,Speed);
  }
}

void motor_stop(int ir0, int ir1, int ir2, int ir3, int ir4){
  Robot.motorsStop();
}
